# 文件转移工具 (FileTransferTool)

## 项目简介

文件转移工具是一个基于Qt开发的桌面应用程序，用于批量转移文件和文件夹。该工具提供了直观的图形界面，支持选择多个源文件夹，并将其中的所有文件（包括子文件夹中的文件）转移到指定的目标目录。

## 功能特性

- **多文件夹选择**: 支持同时选择多个源文件夹进行转移
- **多种转移模式**: 
  - **保持文件夹结构**: 完整复制源文件夹及其子文件夹结构到目标目录
  - **扁平化转移**: 只提取所有文件，忽略文件夹结构，将所有文件放在目标目录根目录下
- **智能文件筛选系统**: 提供多维度的文件筛选功能
  - **文件类型筛选**: 支持按预定义类型（图片、文档、视频、音频、压缩、可执行文件）或自定义扩展名筛选
  - **文件大小筛选**: 设置文件大小范围过滤
  - **修改时间筛选**: 按文件修改时间范围筛选
  - **文件名模式匹配**: 支持通配符和正则表达式匹配
  - **排除列表**: 支持排除特定文件或文件夹
- **直观的类型提示**: 文件类型选择时自动显示包含的后缀名，帮助用户快速识别
- **文件覆盖选项**: 可选择是否覆盖已存在的同名文件，或自动重命名避免冲突
- **进度显示**: 实时显示转移进度和当前处理的文件
- **多线程处理**: 使用独立线程进行文件操作，保持界面响应
- **错误处理**: 完善的错误检测和用户提示机制

## 系统要求

- Windows 操作系统
- Qt 5.12.8 或更高版本
- MinGW 编译器

## 编译说明

1. 确保已安装Qt开发环境
2. 在项目目录中打开命令行
3. 运行以下命令：

```bash
qmake FileTransferTool.pro
mingw32-make
```

4. 编译完成后，可执行文件位于 `release/FileTransferTool.exe`

## 使用说明

1. **添加源文件夹**: 点击"添加文件夹"按钮选择要转移的源文件夹
2. **移除文件夹**: 选中列表中的文件夹，点击"移除选中"按钮
3. **选择目标目录**: 点击"选择目录"按钮指定文件转移的目标位置
4. **选择转移模式**:
   - **保持文件夹结构**: 维持原有的目录层次结构
   - **只提取文件(扁平化)**: 将所有文件提取到目标目录根目录，忽略原有文件夹结构
5. **配置筛选选项**（可选）:
   - **文件类型筛选**: 勾选"启用文件类型筛选"，选择预定义类型或输入自定义扩展名
     - 预定义类型会自动显示包含的后缀名，如图片文件包含：.jpg, .jpeg, .png, .gif, .bmp, .tiff, .webp, .svg, .ico
   - **文件大小筛选**: 设置最小和最大文件大小范围
   - **修改时间筛选**: 选择时间范围或自定义起止时间
   - **文件名筛选**: 使用通配符或正则表达式匹配文件名
   - **排除列表**: 输入要排除的文件或文件夹名称
6. **设置覆盖选项**: 勾选"覆盖已存在的文件"来决定如何处理同名文件
   - 勾选: 直接覆盖已存在的文件
   - 不勾选: 自动重命名文件(如 file.txt → file(1).txt)
7. **开始转移**: 点击"开始转移"按钮启动文件转移过程
8. **查看进度**: 转移过程中可以实时查看进度条和状态信息

## 项目结构

```
FileTransferTool/
├── main.cpp                 # 应用程序入口
├── mainwindow.h/.cpp        # 主窗口类，包含UI逻辑和用户交互
├── mainwindow.ui            # UI界面文件
├── filetransferworker.h/.cpp # 文件转移工作线程，包含核心转移逻辑
├── FileTransferTool.pro     # Qt项目文件
├── release/                 # 编译输出目录
│   └── FileTransferTool.exe # 可执行文件
└── README.md               # 项目说明文档
```

## 技术特点

### 架构设计
- **MVC模式**: 清晰的模型-视图-控制器分离
- **多线程架构**: UI线程与工作线程分离，确保界面流畅
- **信号槽机制**: 使用Qt的信号槽实现组件间通信
- **策略模式**: 通过TransferMode枚举实现不同转移策略

### 核心功能实现
- **递归目录遍历**: 深度优先搜索算法遍历文件夹结构
- **多模式文件转移**: 
  - 结构保持模式: 完整复制目录树结构
  - 扁平化模式: 递归提取所有文件到单一目录
- **智能文件筛选系统**: 
  - 多维度筛选: 支持文件类型、大小、时间、名称模式和排除列表
  - 预定义文件类型: 内置常用文件类型分类及其扩展名映射
  - 动态界面提示: 实时显示选中文件类型包含的后缀名
  - 灵活的匹配模式: 支持通配符和正则表达式
- **智能文件冲突处理**: 支持覆盖或自动重命名策略
- **文件操作**: 使用Qt的QFile和QDir类进行安全的文件操作
- **进度跟踪**: 预先计算总文件数，实现精确的进度显示

### 代码质量
- **完整注释**: 所有函数都有详细的文档注释
- **错误处理**: 全面的异常处理和用户友好的错误提示
- **内存管理**: 正确的Qt对象生命周期管理
- **模块化设计**: 功能模块清晰分离，易于维护和扩展

## 核心类说明

### MainWindow
主窗口类，负责用户界面的创建和交互处理。

主要功能：
- UI界面初始化和布局管理
- 筛选选项界面的创建和管理
- 文件类型后缀名的动态显示
- 用户交互处理和输入验证
- 线程管理和任务调度
- 进度更新显示和状态反馈

核心方法：
- `initUI()`: 初始化用户界面和控件布局
- `updateFileTypeExtensionsDisplay()`: 更新文件类型后缀显示
- `getFileTypeExtensions()`: 获取预定义文件类型的扩展名列表
- `convertSizeToBytes()`: 将大小单位转换为字节数

### FileTransferWorker 类

文件转移工作线程，负责执行实际的文件转移操作。

主要功能：
- 文件转移逻辑实现
- 智能文件筛选处理
- 进度信息反馈
- 错误处理和报告

核心方法：
- `startTransfer()`: 启动文件转移过程，根据模式选择不同策略
- `copyDirectoryRecursively()`: 递归复制目录结构(保持结构模式)
- `copyFilesFlattened()`: 扁平化复制文件(扁平化模式)
- `passesFilter()`: 检查文件是否通过所有筛选条件
- `isExcluded()`: 检查文件是否在排除列表中
- `matchesNamePattern()`: 检查文件名是否匹配指定模式
- `matchesFileType()`: 检查文件类型是否符合筛选条件
- `matchesFileSize()`: 检查文件大小是否在指定范围内
- `matchesModificationTime()`: 检查文件修改时间是否在指定范围内
- `generateUniqueFileName()`: 生成唯一文件名避免冲突
- `calculateTotalFiles()`: 计算总文件数用于进度显示
- `countFilesInDirectory()`: 递归统计目录中的文件数量

### FilterOptions 结构体

文件筛选配置结构，包含所有筛选条件：
- `enableFileTypeFilter`: 是否启用文件类型筛选
- `enableNameFilter`: 是否启用文件名筛选
- `enableSizeFilter`: 是否启用文件大小筛选
- `enableTimeFilter`: 是否启用修改时间筛选
- `enableExcludeFilter`: 是否启用排除列表筛选
- `allowedExtensions`: 允许的文件扩展名列表
- `namePattern`: 文件名匹配模式
- `useRegex`: 是否使用正则表达式匹配
- `minSize`: 最小文件大小(字节)
- `maxSize`: 最大文件大小(字节)
- `startTime`: 修改时间范围起始时间
- `endTime`: 修改时间范围结束时间
- `excludeList`: 排除的文件/文件夹名称列表

### TransferMode 枚举

定义文件转移模式：
- `KeepStructure`: 保持原有文件夹结构
- `FlattenFiles`: 扁平化转移，只提取文件

## 后续扩展功能

以下功能计划在未来版本中实现，以进一步提升用户体验和工具实用性：

### 操作增强功能
- **文件/文件夹的复制、剪切和粘贴**: 基本的文件操作功能
- **文件/文件夹的删除**: 删除不再需要的文件或文件夹
- **文件/文件夹的重命名**: 修改文件或文件夹的名称
- **文件/文件夹的查找**: 根据名称或其他属性查找特定文件
- **文件/文件夹的属性查看和修改**: 查看文件信息并修改权限等属性

### 高级功能
- **文件内容的查看和编辑**: 对文本文件进行查看和简单编辑
- **文件压缩和解压缩**: 打包和解压缩文件功能
- **文件同步**: 与远程存储或其他设备进行文件同步
- **文件加密和解密**: 保护敏感文件的安全性
- **文件比较**: 比较两个文件或文件夹的内容差异
- **重复文件检测**: 识别和处理重复文件
- **断点续传**: 支持大文件传输的断点续传功能
- **任务保存和恢复**: 保存传输任务并支持恢复
- **拖拽支持**: 支持拖拽操作添加文件和文件夹

## 版本信息

- **当前版本**: 3.1.0
- **更新内容**: 
  - 新增智能文件筛选系统
    - 文件类型筛选（支持图片、文档、视频、音频、压缩、可执行文件）
    - 文件大小筛选
    - 修改时间筛选
    - 文件名模式匹配（通配符和正则表达式）
    - 排除列表功能
  - 新增文件类型后缀名动态显示功能
  - 改进用户界面，增加选项卡式筛选配置
  - 修复文件类型匹配逻辑bug
  - 增强用户体验和操作直观性
- **开发环境**: Qt 5.12+ / C++11
- **编译器**: MinGW 7.3.0
- **目标平台**: Windows

## 许可证

本项目仅供学习和个人使用。