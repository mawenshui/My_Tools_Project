# 代码行数统计工具项目需求文档（UI优化版）

## 项目概述

本项目旨在开发一个功能强大且用户友好的代码行数统计工具，具备现代化的可视化界面。该工具将提供直观的操作体验，符合用户的使用习惯，同时保持专业的代码分析能力。

## 用户界面设计原则

### 设计理念
- **简洁直观**：界面布局清晰，功能一目了然
- **响应式设计**：适配不同屏幕尺寸和设备
- **现代化风格**：采用现代扁平化设计语言
- **用户友好**：符合用户操作习惯，降低学习成本
- **数据可视化**：通过图表和图形直观展示统计结果

### 界面架构
1. **主界面**：项目选择和基础配置
2. **统计结果界面**：详细的统计数据展示
3. **可视化界面**：图表和图形展示
4. **比较界面**：版本对比和差异分析
5. **设置界面**：工具配置和个性化设置
6. **报告界面**：导出和分享功能

## 核心功能需求（按优先级）

### 优先级 P0 - 核心UI功能（必须实现）

#### 1. 主界面设计
- **项目选择区域**
  - 拖拽上传支持
  - 文件夹浏览器
  - 最近项目列表
  - 项目收藏功能

- **快速配置面板**
  - 语言选择器（多选）
  - 排除规则设置
  - 统计选项开关
  - 一键开始分析按钮

#### 2. 统计结果展示
- **概览卡片**
  - 总行数、代码行、注释行、空白行
  - 文件数量、语言数量
  - 处理时间和性能指标

- **详细统计表格**
  - 按语言分组的统计数据
  - 可排序的表格列
  - 搜索和过滤功能
  - 展开/折叠详细信息

#### 3. 基础可视化
- **饼图**：语言占比分布
- **柱状图**：各语言代码行数对比
- **进度条**：注释覆盖率
- **仪表盘**：代码质量指标

#### 4. 响应式布局
- 桌面端优化布局
- 平板和手机适配
- 侧边栏折叠功能
- 全屏模式支持

### 优先级 P1 - 增强UI功能（重要）

#### 1. 高级可视化
- **树状图**：文件结构和大小可视化
- **热力图**：代码密度分布
- **时间线图**：项目演化趋势
- **雷达图**：多维度代码质量评估

#### 2. 交互式功能
- **实时搜索**：即时过滤和高亮
- **工具提示**：悬停显示详细信息
- **上下文菜单**：右键操作菜单
- **键盘快捷键**：提高操作效率

#### 3. 数据导出界面
- **报告模板选择**
- **自定义报告配置**
- **预览功能**
- **多格式导出**（PDF、Excel、HTML）

#### 4. 主题和个性化
- **深色/浅色主题切换**
- **颜色方案自定义**
- **字体大小调节**
- **界面布局保存**

### 优先级 P2 - 高级UI功能（可选）

#### 1. 项目管理界面
- **项目仪表板**
- **项目对比视图**
- **历史记录管理**
- **标签和分类系统**

#### 2. 协作功能界面
- **分享链接生成**
- **评论和注释系统**
- **团队协作面板**
- **权限管理界面**

#### 3. 高级分析界面
- **代码质量趋势图**
- **技术债务分析**
- **性能瓶颈识别**
- **重构建议面板**

### 优先级 P3 - 未来UI扩展（规划）

#### 1. AI辅助界面
- **智能分析建议**
- **自动化报告生成**
- **异常检测提醒**
- **优化建议面板**

#### 2. 集成界面
- **IDE插件界面**
- **CI/CD集成面板**
- **版本控制集成**
- **第三方工具连接**

## 技术实现规格

### 开发环境
- **IDE**：Qt Creator
- **编译器**：MinGW (Minimalist GNU for Windows)
- **框架**：Qt 6.x (推荐最新LTS版本)
- **语言**：C++ (优先使用Qt原生数据类型和函数)
- **构建系统**：CMake 或 qmake

### Qt技术栈
- **UI框架**：Qt Widgets / Qt Quick (QML)
- **数据类型**：QString, QStringList, QVector, QHash, QVariant 等Qt原生类型
- **文件处理**：QFile, QDir, QFileInfo, QTextStream
- **图表组件**：Qt Charts 模块
- **网络功能**：Qt Network 模块
- **多线程**：QThread, QtConcurrent
- **数据库**：Qt SQL 模块 (可选)
- **JSON处理**：QJsonDocument, QJsonObject, QJsonArray

### 用户体验要求
- **启动时间**：应用启动 < 3秒
- **响应时间**：UI操作响应 < 500ms
- **兼容性**：支持 Windows 10/11 (主要)，Linux, macOS (次要)
- **内存使用**：正常运行内存占用 < 200MB
- **可访问性**：支持键盘导航和屏幕阅读器

### 界面性能优化
- **模型/视图架构**：使用QAbstractItemModel处理大量数据
- **延迟加载**：使用QTimer实现按需加载
- **缓存策略**：QSettings存储用户配置，QCache缓存计算结果
- **多线程处理**：使用QThread和QtConcurrent处理耗时操作
- **内存管理**：合理使用Qt的父子对象机制自动管理内存

## 用户交互流程

### 主要使用流程
1. **项目导入** → 拖拽或选择项目文件夹
2. **配置设置** → 选择语言、设置排除规则
3. **开始分析** → 一键启动统计分析
4. **结果查看** → 多维度查看统计结果
5. **深入分析** → 使用可视化工具深入分析
6. **导出报告** → 生成和分享分析报告

### 快捷操作
- **快速重新分析**：配置变更后一键重新统计
- **收藏项目**：常用项目快速访问
- **模板应用**：预设配置快速应用
- **历史对比**：与历史版本快速对比

## 界面布局设计

### 主界面布局
```
┌─────────────────────────────────────────────────────────┐
│  Header: Logo + Navigation + User Menu                 │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────┐ ┌─────────────────────────────────┐ │
│ │   Sidebar       │ │        Main Content Area        │ │
│ │ - Recent        │ │ ┌─────────────────────────────┐ │ │
│ │ - Favorites     │ │ │     Project Upload Zone     │ │ │
│ │ - Settings      │ │ │   (Drag & Drop Support)    │ │ │
│ │ - Help          │ │ └─────────────────────────────┘ │ │
│ └─────────────────┘ │ ┌─────────────────────────────┐ │ │
│                     │ │    Quick Config Panel       │ │ │
│                     │ │  - Language Selection       │ │ │
│                     │ │  - Exclude Rules            │ │ │
│                     │ │  - Analysis Options         │ │ │
│                     │ └─────────────────────────────┘ │ │
│                     └─────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│  Footer: Status + Progress + Quick Actions              │
└─────────────────────────────────────────────────────────┘
```

### 结果展示界面布局
```
┌─────────────────────────────────────────────────────────┐
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐         │
│ │ Total   │ │ Code    │ │Comment  │ │ Blank   │  Cards  │
│ │ Lines   │ │ Lines   │ │ Lines   │ │ Lines   │         │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘         │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────┐ ┌─────────────────────────────┐ │
│ │    Language Pie     │ │     Detailed Statistics     │ │
│ │       Chart         │ │         Table               │ │
│ │                     │ │   (Sortable & Filterable)   │ │
│ └─────────────────────┘ └─────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │              File Structure Tree View               │ │
│ │            (Interactive & Expandable)              │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

## Qt应用架构设计

### 核心模块设计
- **主窗口模块** (MainWindow)
  - 继承QMainWindow
  - 集成菜单栏、工具栏、状态栏
  - 管理各个功能模块的切换

- **文件分析模块** (CodeAnalyzer)
  - 使用QDir递归遍历目录
  - QTextStream读取文件内容
  - QRegularExpression进行模式匹配
  - QThread实现后台分析

- **数据模型模块** (DataModels)
  - QAbstractTableModel用于统计表格
  - QAbstractItemModel用于文件树
  - QStandardItemModel用于语言列表

- **图表显示模块** (ChartWidgets)
  - 基于Qt Charts的饼图、柱状图
  - 自定义QWidget绘制特殊图表
  - QPainter实现自定义可视化

- **配置管理模块** (SettingsManager)
  - QSettings存储用户配置
  - QJsonDocument处理配置文件
  - 单例模式管理全局设置

### Qt特定实现要点
- **信号槽机制**：用于模块间通信
- **事件系统**：处理用户交互和系统事件
- **样式表**：使用QSS实现界面美化
- **国际化**：QTranslator支持多语言
- **资源系统**：qrc文件管理图标和样式

## 实施计划

### 第一阶段：Qt项目框架搭建（3周）
- 创建Qt Creator项目，配置CMake/qmake
- 设计主窗口布局，实现基础UI框架
- 实现文件选择和基础配置界面
- 集成Qt Charts模块

### 第二阶段：核心分析功能（5周）
- 实现代码文件扫描和解析逻辑
- 开发多线程分析引擎
- 创建数据模型和视图组件
- 实现基础统计结果展示

### 第三阶段：可视化和高级功能（6周）
- 集成Qt Charts实现各种图表
- 开发版本对比功能
- 实现数据导出（JSON、CSV、PDF）
- 添加主题切换和个性化设置

### 第四阶段：优化和扩展（4周）
- 性能优化和内存管理
- 添加键盘快捷键支持
- 实现插件架构（可选）
- 完善错误处理和日志系统

## Qt开发优势

### 技术优势
- **跨平台性**：一套代码支持Windows、Linux、macOS
- **原生性能**：编译为本地代码，性能优异
- **丰富组件**：Qt提供完整的UI组件库
- **内存管理**：父子对象机制简化内存管理
- **信号槽**：类型安全的事件处理机制

### 开发效率
- **Qt Creator**：专业的集成开发环境
- **Qt Designer**：可视化UI设计工具
- **Qt Assistant**：完整的API文档
- **调试工具**：强大的调试和性能分析工具

### 部署优势
- **静态链接**：可生成独立可执行文件
- **安装包**：Qt Installer Framework制作安装程序
- **自动更新**：Qt Network支持在线更新

## 总结

本项目采用Qt Creator + MinGW技术栈，充分利用Qt框架的跨平台特性和丰富的组件库。通过Qt原生数据类型和API，实现高性能的桌面应用程序。项目架构清晰，模块化设计便于维护和扩展，为用户提供专业、高效的代码统计分析工具。